function checkSignature(t){var i=Office.context.roamingSettings.get("user_info");if(console.log("check signature - "+i),i){var e=JSON.parse(i);Office.context.mailbox.item.getComposeTypeAsync?Office.context.mailbox.item.getComposeTypeAsync({asyncContext:{user_info:e,eventObj:t}},(function(t){"succeeded"===t.status&&insert_auto_signature(t.value.composeType,t.asyncContext.user_info,t.asyncContext.eventObj)})):insert_auto_signature("newMail",JSON.parse(i),t)}else display_insight_infobar()}function insert_auto_signature(t,i,e){addTemplateSignature(get_signature_info(get_template_name(t),i),e)}function addTemplateSignature(t,i,e){!0===is_valid_data(t.logoBase64)?Office.context.mailbox.item.addFileAttachmentFromBase64Async(t.logoBase64,t.logoFileName,{isInline:!0},(function(e){Office.context.mailbox.item.body.setSignatureAsync(t.signature,{coercionType:"html",asyncContext:i},(function(t){t.asyncContext.completed()}))})):Office.context.mailbox.item.body.setSignatureAsync(t.signature,{coercionType:"html",asyncContext:i},(function(t){t.asyncContext.completed()}))}function display_insight_infobar(){console.log("its  enetered display infobar"),Office.context.mailbox.item.notificationMessages.addAsync("fd90eb33431b46f58a68720c36154b4a",{type:"insightMessage",message:"Please set your signature with Drei Outlook add-in.",icon:"Icon.16x16",actions:[{actionType:"showTaskPane",actionText:"Signatures Generator",commandId:get_command_id(),contextData:"{''}"}]})}function get_template_name(t){return Office.context.roamingSettings.get("newMail")}function get_signature_info(t,i){return"templateB"===t?get_template_B_info(i):"templateW"===t?get_template_W_info(i):get_template_S_info(i)}function get_command_id(){return"appointment"==Office.context.mailbox.item.itemType?"MRCS_TpBtn1":"MRCS_TpBtn0"}function get_template_S_info(t){var i="";if(i+="<table style='color: black; font-family: Arial, sans-serif; font-size: 8pt;'>",i+="<tr>",i+="<td style='padding-left: 5px;'>",i+="<span style='color: rgb(0, 160, 210); font-family: Arial, sans-serif;font-size: 10pt;font-weight: bold;'>"+t.name+"</span>",i+="<br/>",is_valid_data(t.job)&&(i+="<div style='color: black; font-family: Arial, sans-serif; font-size: 8pt;'>"+t.job+"</div>"),i+="<br/>",is_valid_data(t.phone)&&(i+="<div>Mobil: "+t.phone+"</div>"),t.fixflag&&is_valid_data(t.fix)&&(i+="<div>Fix: "+t.fix+"</div>"),t.faxflag&&is_valid_data(t.fax)&&(i+="<div>Fax: "+t.fax+"</div>"),i+="<div style='color: black; font-family: Arial, sans-serif; font-size: 8pt;' ><a href=mailto:"+t.email+">"+t.email+"</a></div>",i+="<div style='color: black; font-family: Arial, sans-serif; font-size: 8pt;' ><a href='https://www.drei.at'>www.drei.at</a></div>",i+="</td>",i+="</tr>",i+="<td style='padding-left: 5px;'>",i+="<br/>",i+="<img src='https://h3aoutlooksignature-test.azurewebsites.net/assets/DreiLogo-64.png' alt='Logo' />",i+="<br/>",i+="<br/>",i+="</td>",i+="</tr>",i+="<tr>",i+="<td style='padding-left: 5px;'>",i+="<span style='color: black; font-family: Arial, sans-serif; font-size: 10pt; font-weight: bold;'>Drei.</span>",i+="<span>Macht's einfach.</span>",i+="</td>",i+="</tr>",i+="<tr>",i+="<td style='padding-left: 5px;'>",i+="<br/>",i+="<div style='color: black; font-family: Arial, sans-serif; font-size: 8pt; font-weight: bold;'>Hutchison Drei Austria GmbH</div>",t.location.toLowerCase().startsWith("drei shop")&&(i+="<div style='color: black; font-family: Arial, sans-serif; font-size: 8pt; font-weight: bold;'>"+t.location+"</div>"),i+="<div style='color: black; font-family: Arial, sans-serif; font-size: 8pt;'>"+t.address+"</div>",i+="<div style='color: black; font-family: Arial, sans-serif; font-size: 8pt;'>FN 140132b, Handelsgericht Wien</div>",i+="</td>",i+="</tr>",t.officetimeflag&&is_valid_data(t.officetime)){var e=t.officetime.replaceAll("Uhr","Uhr <br />");console.log(e),i+="<tr>",i+="<td style='padding-left: 5px;'>",i+="<br/>",i+="<div style='color: black; font-family: Arial, sans-serif; font-size: 8pt;'>"+e+"</div>",i+="</td>",i+="</tr>"}return{signature:i+="</table>",logoBase64:null,logoFileName:null}}function get_template_B_info(t){var i="";if(i+="<table style='color: black; font-family: Arial, sans-serif; font-size: 8pt;'>",i+="<tr>",i+="<td style='padding-left: 5px;'>",i+="<span style='color: rgb(0, 160, 210); font-family: Arial, sans-serif;font-size: 10pt;font-weight: bold;'>"+t.name+"</span>",i+="<br/>",is_valid_data(t.job)&&(i+="<div style='color: black; font-family: Arial, sans-serif; font-size: 8pt;'>"+t.job+"</div>"),i+="<br/>",is_valid_data(t.phone)&&(i+="<div>Mobil: "+t.phone+"</div>"),t.fixflag&&is_valid_data(t.fix)&&(i+="<div>Fix: "+t.fix+"</div>"),t.faxflag&&is_valid_data(t.fax)&&(i+="<div>Fax: "+t.fax+"</div>"),i+="<div style='color: black; font-family: Arial, sans-serif; font-size: 8pt;' ><a href=mailto:"+t.email+">"+t.email+"</a></div>",i+="<div style='color: black; font-family: Arial, sans-serif; font-size: 8pt;' ><a href='https://www.drei.at'>www.drei.at</a></div>",i+="</td>",i+="</tr>",i+="<td style='padding-left: 5px;'>",i+="<br/>",i+="<img src='https://h3aoutlooksignature-test.azurewebsites.net/assets/DreiLogo-64.png' alt='Logo' />",i+="<br/>",i+="<br/>",i+="</td>",i+="</tr>",i+="<tr>",i+="<td style='padding-left: 5px;'>",i+="<span style='color: black; font-family: Arial, sans-serif; font-size: 10pt; font-weight: bold;'>Drei</span>",i+="<span style='color: rgb(0, 160, 210); font-family: Arial, sans-serif; font-size: 10pt;'>Business.</span>",i+="<div><span>Macht's einfach.</span></div>",i+="</td>",i+="</tr>",i+="<tr>",i+="<td style='padding-left: 5px;'>",i+="<br/>",i+="<div style='color: black; font-family: Arial, sans-serif; font-size: 8pt; font-weight: bold;'>Hutchison Drei Austria GmbH</div>",t.location.toLowerCase().startsWith("drei shop")&&(i+="<div style='color: black; font-family: Arial, sans-serif; font-size: 8pt; font-weight: bold;'>"+t.location+"</div>"),i+="<div style='color: black; font-family: Arial, sans-serif; font-size: 8pt;'>"+t.address+"</div>",i+="<div style='color: black; font-family: Arial, sans-serif; font-size: 8pt;'>FN 140132b, Handelsgericht Wien</div>",i+="</td>",i+="</tr>",t.officetimeflag&&is_valid_data(t.officetime)){var e=t.officetime.replaceAll("Uhr","Uhr <br />");console.log(e),i+="<tr>",i+="<td style='padding-left: 5px;'>",i+="<br/>",i+="<div style='color: black; font-family: Arial, sans-serif; font-size: 8pt;'>"+e+"</div>",i+="</td>",i+="</tr>"}return{signature:i+="</table>",logoBase64:null,logoFileName:null}}function get_template_W_info(t){var i="";if(i+="<table style='color: black; font-family: Arial, sans-serif; font-size: 8pt;'>",i+="<tr>",i+="<td style='padding-left: 5px;'>",i+="<span style='color: rgb(0, 160, 210); font-family: Arial, sans-serif;font-size: 10pt;font-weight: bold;'>"+t.name+"</span>",i+="<br/>",is_valid_data(t.job)&&(i+="<div style='color: black; font-family: Arial, sans-serif; font-size: 8pt;'>"+t.job+"</div>"),i+="<br/>",is_valid_data(t.phone)&&(i+="<div>Mobil: "+t.phone+"</div>"),t.fixflag&&is_valid_data(t.fix)&&(i+="<div>Fix: "+t.fix+"</div>"),t.faxflag&&is_valid_data(t.fax)&&(i+="<div>Fax: "+t.fax+"</div>"),i+="<div style='color: black; font-family: Arial, sans-serif; font-size: 8pt;' ><a href=mailto:"+t.email+">"+t.email+"</a></div>",i+="<div style='color: black; font-family: Arial, sans-serif; font-size: 8pt;' ><a href='https://www.drei.at'>www.drei.at</a></div>",i+="</td>",i+="</tr>",i+="<td style='padding-left: 5px;'>",i+="<br/>",i+="<img src='https://h3aoutlooksignature-test.azurewebsites.net/assets/DreiLogo-64.png' alt='Logo' />",i+="<br/>",i+="<br/>",i+="</td>",i+="</tr>",i+="<tr>",i+="<td style='padding-left: 5px;'>",i+="<span style='color: black; font-family: Arial, sans-serif; font-size: 10pt; font-weight: bold;'>Drei</span>",i+="<span style='color: rgb(0, 160, 210); font-family: Arial, sans-serif; font-size: 10pt;'>Wholesale.</span>",i+="<div><span>Macht's einfach.</span></div>",i+="</td>",i+="</tr>",i+="<tr>",i+="<td style='padding-left: 5px;'>",i+="<br/>",i+="<div style='color: black; font-family: Arial, sans-serif; font-size: 8pt; font-weight: bold;'>Hutchison Drei Austria GmbH</div>",t.location.toLowerCase().startsWith("drei shop")&&(i+="<div style='color: black; font-family: Arial, sans-serif; font-size: 8pt; font-weight: bold;'>"+t.location+"</div>"),i+="<div style='color: black; font-family: Arial, sans-serif; font-size: 8pt;'>"+t.address+"</div>",i+="<div style='color: black; font-family: Arial, sans-serif; font-size: 8pt;'>FN 140132b, Handelsgericht Wien</div>",i+="</td>",i+="</tr>",t.officetimeflag&&is_valid_data(t.officetime)){var e=t.officetime.replaceAll("Uhr","Uhr <br />");console.log(e),i+="<tr>",i+="<td style='padding-left: 5px;'>",i+="<br/>",i+="<div style='color: black; font-family: Arial, sans-serif; font-size: 8pt;'>"+e+"</div>",i+="</td>",i+="</tr>"}return{signature:i+="</table>",logoBase64:null,logoFileName:null}}function is_valid_data(t){return null!=t&&""!==t}Office.actions.associate("checkSignature",checkSignature);